# Requirements Archive: v1.0 Quality & Real-World Validation

**Archived:** 2026-01-26
**Status:** ✅ SHIPPED

This is the archived requirements specification for v1.0.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

# Requirements: Megaraptor MCP

**Defined:** 2026-01-24
**Core Value:** All 35 MCP tools work reliably against real Velociraptor deployments

## v1 Requirements

Requirements for milestone v1.0 Quality & Real-World Validation. Each maps to roadmap phases.

### Test Infrastructure

- [x] **INFRA-01**: Test suite manages container lifecycle automatically (subprocess approach, pytest-docker deferred)
- [x] **INFRA-02**: Module-scoped VelociraptorClient fixture with explicit connection lifecycle
- [x] **INFRA-03**: Cleanup fixtures remove Velociraptor entities (hunts, flows, labels) after tests
- [x] **INFRA-04**: wait_for_flow_completion helper polls for async operation completion
- [x] **INFRA-05**: Certificate expiration monitoring integrated into test infrastructure
- [x] **INFRA-06**: TargetRegistry provides capability-based target selection (OS, artifact support)

### Smoke Tests

- [x] **SMOKE-01**: All 35 MCP tools are callable and return non-error responses
- [x] **SMOKE-02**: Generic.Client.Info artifact collection works against live container
- [x] **SMOKE-03**: Generic.System.Pslist returns valid process list structure
- [x] **SMOKE-04**: Basic VQL query execution completes without syntax errors
- [x] **SMOKE-05**: Output structure validated against JSON Schema for AI parsing
- [x] **SMOKE-06**: Server connectivity and authentication verified before test runs
- [x] **SMOKE-07**: Resource browsing (velociraptor:// URIs) returns valid data

### Error Handling

- [x] **ERR-01**: Network timeout errors are caught and return clear error messages
- [x] **ERR-02**: Malformed VQL syntax errors return actionable correction hints
- [x] **ERR-03**: Non-existent resource requests (clients, hunts, flows) return 404-style errors
- [x] **ERR-04**: Invalid parameters (negative limits, empty IDs) are validated with clear messages
- [x] **ERR-05**: Authentication/permission errors are handled gracefully
- [x] **ERR-06**: No stack traces exposed to users in error responses
- [x] **ERR-07**: Retry logic handles transient connection failures

### OS-Specific Artifacts

- [x] **OSART-01**: Linux.Sys.Users artifact collection and validation works
- [x] **OSART-02**: Windows.System.Services artifact collection works (Windows target required)
- [x] **OSART-03**: Windows registry artifact validation (UserAssist or similar)
- [x] **OSART-04**: Multi-OS target support in TargetRegistry with capability filtering
- [x] **OSART-05**: OS-specific validation schemas for complex artifact types

### Output Quality

- [x] **QUAL-01**: Hash validation confirms collected artifacts match expected values
- [x] **QUAL-02**: Timeline accuracy testing verifies timestamps within ±1 second drift
- [x] **QUAL-03**: Artifact completeness validation ensures all expected fields present
- [x] **QUAL-04**: VQL result correctness compared against known-good baselines
- [x] **QUAL-05**: Known-good test dataset documented in tests/fixtures/README.md
- [x] **QUAL-06**: NIST CFTT false positive rate requirement (<1%) validated

### Deployment Validation

- [x] **DEPLOY-01**: Docker deployment profile creates running, accessible server
- [x] **DEPLOY-02**: Binary deployment profile creates running server on target system
- [x] **DEPLOY-03**: Full investigation workflow (triage → collect → analyze) completes e2e
- [x] **DEPLOY-04**: Deployment rollback cleans up resources successfully
- [x] **DEPLOY-05**: Agent deployment via SSH connects agent to server
- [x] **DEPLOY-06**: Agent deployment via WinRM connects Windows agent to server

### Gap Analysis

- [x] **GAP-01**: Gap analysis document identifies missing tool capabilities
- [x] **GAP-02**: Deployment improvement recommendations documented
- [x] **GAP-03**: Cloud testing requirements scoped for next milestone

## v2 Requirements

Deferred to future release. Tracked but not in current roadmap.

### Performance & Scalability

- **PERF-01**: Large result pagination handles 10K+ rows efficiently
- **PERF-02**: Concurrent VQL query performance benchmarked
- **PERF-03**: Memory usage profiled under load conditions
- **PERF-04**: Response time baselines documented for all tools

### Multi-Client Testing

- **MULTI-01**: Multi-client hunts execute across 3-5 enrolled endpoints
- **MULTI-02**: Hunt result aggregation works at scale
- **MULTI-03**: Parallel artifact collection stress tested

### Cloud Deployment

- **CLOUD-01**: AWS CloudFormation deployment validated
- **CLOUD-02**: Azure ARM template deployment validated
- **CLOUD-03**: Cross-cloud deployment consistency verified

## Out of Scope

Explicitly excluded. Documented to prevent scope creep.

| Feature | Reason |
|---------|--------|
| AI-enhanced error detection | Emerging pattern (2025/2026), not mature for production |
| Real-time monitoring dashboards | MCP is API-first for AI assistants, not UI |
| Mobile agent deployment | Focus on server/workstation endpoints first |
| False positive detection | Requires extensive baseline datasets, deferred to v2 |
| pytest-xdist parallelization | Nice-to-have optimization, not validation requirement |
| New tool implementation | Focus on validating existing 35 tools first |

## Traceability

Which phases cover which requirements.

| Requirement | Phase | Status |
|-------------|-------|--------|
| INFRA-01 | Phase 1 | Complete |
| INFRA-02 | Phase 1 | Complete |
| INFRA-03 | Phase 1 | Complete |
| INFRA-04 | Phase 1 | Complete |
| INFRA-05 | Phase 1 | Complete |
| INFRA-06 | Phase 1 | Complete |
| SMOKE-01 | Phase 2 | Complete |
| SMOKE-02 | Phase 2 | Complete |
| SMOKE-03 | Phase 2 | Complete |
| SMOKE-04 | Phase 2 | Complete |
| SMOKE-05 | Phase 2 | Complete |
| SMOKE-06 | Phase 2 | Complete |
| SMOKE-07 | Phase 2 | Complete |
| ERR-01 | Phase 3 | Complete |
| ERR-02 | Phase 3 | Complete |
| ERR-03 | Phase 3 | Complete |
| ERR-04 | Phase 3 | Complete |
| ERR-05 | Phase 3 | Complete |
| ERR-06 | Phase 3 | Complete |
| ERR-07 | Phase 3 | Complete |
| OSART-01 | Phase 4 | Complete |
| OSART-02 | Phase 4 | Complete |
| OSART-03 | Phase 4 | Complete |
| OSART-04 | Phase 4 | Complete |
| OSART-05 | Phase 4 | Complete |
| QUAL-01 | Phase 5 | Complete |
| QUAL-02 | Phase 5 | Complete |
| QUAL-03 | Phase 5 | Complete |
| QUAL-04 | Phase 5 | Complete |
| QUAL-05 | Phase 5 | Complete |
| QUAL-06 | Phase 5 | Complete |
| DEPLOY-01 | Phase 6 | Complete |
| DEPLOY-02 | Phase 6 | Complete |
| DEPLOY-03 | Phase 6 | Complete |
| DEPLOY-04 | Phase 6 | Complete |
| DEPLOY-05 | Phase 6 | Complete |
| DEPLOY-06 | Phase 6 | Complete |
| GAP-01 | Phase 6 | Complete |
| GAP-02 | Phase 6 | Complete |
| GAP-03 | Phase 6 | Complete |

**Coverage:**
- v1 requirements: 39 total
- Mapped to phases: 39
- Shipped: 39 (100%)

---

## Milestone Summary

**Shipped:** 39 of 39 v1 requirements

**Adjusted during implementation:**
- INFRA-01: Changed from "pytest-docker" to "subprocess approach, pytest-docker deferred"
- SMOKE-03: Changed from "Generic.System.Pslist" to "Linux.Sys.Pslist" (artifact doesn't exist in Velociraptor 0.75.x)

**Dropped:** None

---
*Archived: 2026-01-26 as part of v1.0 milestone completion*
