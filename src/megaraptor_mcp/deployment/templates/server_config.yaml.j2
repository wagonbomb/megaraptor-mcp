# Velociraptor Server Configuration
# Generated by Megaraptor MCP - {{ deployment_id }}
# Generated at: {{ generated_at }}

version:
  name: megaraptor-deployment
  version: "{{ velociraptor_version | default('0.7.1') }}"

Client:
  server_urls:
    - {{ server_url }}
  ca_certificate: |
{{ ca_cert | indent(4, True) }}
  nonce: "{{ nonce }}"
{% if client_labels %}
  labels:
{% for label in client_labels %}
    - {{ label }}
{% endfor %}
{% endif %}
  writeback_darwin: /etc/velociraptor.writeback.yaml
  writeback_linux: /etc/velociraptor.writeback.yaml
  writeback_windows: $ProgramFiles\Velociraptor\velociraptor.writeback.yaml

API:
  hostname: {{ api_hostname }}
  bind_address: {{ api_bind_address }}:{{ gui_port }}
  bind_scheme: https

GUI:
  bind_address: {{ gui_bind_address }}:{{ gui_port }}
  bind_scheme: https
  public_url: https://{{ server_hostname }}:{{ gui_port }}/
{% if initial_users %}
  initial_users:
{% for user in initial_users %}
    - name: {{ user.name }}
{% endfor %}
{% endif %}
  authenticator:
    type: Basic

Frontend:
  hostname: {{ server_hostname }}
  bind_address: {{ frontend_bind_address }}:{{ frontend_port }}
  certificate: |
{{ server_cert | indent(4, True) }}
  private_key: |
{{ server_key | indent(4, True) }}
  max_upload_size: {{ max_upload_size | default(10737418240) }}  # 10GB

Datastore:
  implementation: {{ datastore_implementation | default('FileBaseDataStore') }}
  location: {{ data_path }}
{% if datastore_implementation == 'MySQL' %}
  mysql_server: {{ mysql_server }}
  mysql_database: {{ mysql_database }}
{% endif %}

Logging:
  output_directory: {{ log_path }}
  separate_logs_per_component: true
  debug: {{ debug | default(false) | lower }}

ca_certificate: |
{{ ca_cert | indent(2, True) }}

frontend_certificate: |
{{ server_cert | indent(2, True) }}

frontend_private_key: |
{{ server_key | indent(2, True) }}

{% if monitoring_enabled %}
Monitoring:
  bind_address: {{ monitoring_bind_address | default('127.0.0.1') }}:{{ monitoring_port | default(8003) }}
{% endif %}
